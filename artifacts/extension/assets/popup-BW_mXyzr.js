var se=Object.defineProperty;var ue=(e,t,n)=>t in e?se(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var D=(e,t,n)=>ue(e,typeof t!="symbol"?t+"":t,n);import{p as $}from"./logger-mdW3G7Ld.js";function M(){}function oe(e){return e()}function X(){return Object.create(null)}function C(e){e.forEach(oe)}function le(e){return typeof e=="function"}function ce(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function ae(e){return Object.keys(e).length===0}function a(e,t){e.appendChild(t)}function I(e,t,n){e.insertBefore(t,n||null)}function P(e){e.parentNode&&e.parentNode.removeChild(e)}function y(e){return document.createElement(e)}function F(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function S(e){return document.createTextNode(e)}function E(){return S(" ")}function B(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function u(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function de(e){return Array.from(e.childNodes)}function G(e,t){t=""+t,e.data!==t&&(e.data=t)}let T;function N(e){T=e}function fe(){if(!T)throw new Error("Function called outside component initialization");return T}function pe(e){fe().$$.on_mount.push(e)}const U=[],Y=[];let j=[];const Z=[],me=Promise.resolve();let K=!1;function he(){K||(K=!0,me.then(ie))}function Q(e){j.push(e)}const q=new Set;let O=0;function ie(){if(O!==0)return;const e=T;do{try{for(;O<U.length;){const t=U[O];O++,N(t),ge(t.$$)}}catch(t){throw U.length=0,O=0,t}for(N(null),U.length=0,O=0;Y.length;)Y.pop()();for(let t=0;t<j.length;t+=1){const n=j[t];q.has(n)||(q.add(n),n())}j.length=0}while(U.length);for(;Z.length;)Z.pop()();K=!1,q.clear(),N(e)}function ge(e){if(e.fragment!==null){e.update(),C(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Q)}}function be(e){const t=[],n=[];j.forEach(r=>e.indexOf(r)===-1?t.push(r):n.push(r)),n.forEach(r=>r()),j=t}const _e=new Set;function we(e,t){e&&e.i&&(_e.delete(e),e.i(t))}function ye(e,t,n){const{fragment:r,after_update:o}=e.$$;r&&r.m(t,n),Q(()=>{const l=e.$$.on_mount.map(oe).filter(le);e.$$.on_destroy?e.$$.on_destroy.push(...l):C(l),e.$$.on_mount=[]}),o.forEach(Q)}function xe(e,t){const n=e.$$;n.fragment!==null&&(be(n.after_update),C(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function ke(e,t){e.$$.dirty[0]===-1&&(U.push(e),he(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Re(e,t,n,r,o,l,s=null,b=[-1]){const x=T;N(e);const d=e.$$={fragment:null,ctx:[],props:l,update:M,not_equal:o,bound:X(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(x?x.$$.context:[])),callbacks:X(),dirty:b,skip_bound:!1,root:t.target||x.$$.root};s&&s(d.root);let R=!1;if(d.ctx=n?n(e,t.props||{},(f,v,...c)=>{const p=c.length?c[0]:v;return d.ctx&&o(d.ctx[f],d.ctx[f]=p)&&(!d.skip_bound&&d.bound[f]&&d.bound[f](p),R&&ke(e,f)),v}):[],d.update(),R=!0,C(d.before_update),d.fragment=r?r(d.ctx):!1,t.target){if(t.hydrate){const f=de(t.target);d.fragment&&d.fragment.l(f),f.forEach(P)}else d.fragment&&d.fragment.c();t.intro&&we(e.$$.fragment),ye(e,t.target,t.anchor),ie()}N(x)}class Ae{constructor(){D(this,"$$");D(this,"$$set")}$destroy(){xe(this,1),this.$destroy=M}$on(t,n){if(!le(n))return M;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const o=r.indexOf(n);o!==-1&&r.splice(o,1)}}$set(t){this.$$set&&!ae(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Ee="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Ee);function ee(e){let t,n,r;return{c(){t=F("svg"),n=F("circle"),r=F("path"),u(n,"class","opacity-25"),u(n,"cx","12"),u(n,"cy","12"),u(n,"r","10"),u(n,"stroke","currentColor"),u(n,"stroke-width","4"),u(r,"class","opacity-75"),u(r,"fill","currentColor"),u(r,"d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),u(t,"class","animate-spin h-4 w-4 text-white"),u(t,"xmlns","http://www.w3.org/2000/svg"),u(t,"fill","none"),u(t,"viewBox","0 0 24 24")},m(o,l){I(o,t,l),a(t,n),a(t,r)},d(o){o&&P(t)}}}function te(e){let t,n,r;return{c(){t=y("button"),t.textContent="View Report",u(t,"class","w-full px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors")},m(o,l){I(o,t,l),n||(r=B(t,"click",e[6]),n=!0)},p:M,d(o){o&&P(t),n=!1,r()}}}function ne(e){let t,n,r,o,l;return{c(){t=y("div"),n=y("div"),n.textContent="Error",r=E(),o=y("div"),l=S(e[2]),u(n,"class","text-sm text-red-800 font-medium mb-1"),u(o,"class","text-sm text-red-700"),u(t,"class","mt-4 p-3 bg-red-50 border border-red-200 rounded-md")},m(s,b){I(s,t,b),a(t,n),a(t,r),a(t,o),a(o,l)},p(s,b){b&4&&G(l,s[2])},d(s){s&&P(t)}}}function ve(e){let t,n,r,o,l,s,b=e[1]?"Running audit...":"Run Audit",x,d,R,f,v,c,p,i,w,A,L,z,H,V,J,W,_=e[1]&&ee(),h=e[4]&&te(e),g=e[2]&&ne(e);return{c(){t=y("main"),n=y("h1"),n.textContent="OnboardingAudit.ai",r=E(),o=y("div"),l=y("button"),_&&_.c(),s=E(),x=S(b),d=E(),h&&h.c(),R=E(),f=y("button"),v=S("Export JSON"),p=E(),i=y("button"),w=S("Export HTML"),L=E(),g&&g.c(),z=E(),H=y("div"),V=S(e[0]),u(n,"class","text-xl font-bold text-gray-800 mb-4"),l.disabled=e[1],u(l,"class","w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2"),f.disabled=c=!e[3],u(f,"class","w-full px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"),i.disabled=A=!e[3],u(i,"class","w-full px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"),u(o,"class","space-y-3"),u(H,"class","mt-4 text-sm text-gray-600"),u(t,"class","w-80 p-6 bg-white")},m(m,k){I(m,t,k),a(t,n),a(t,r),a(t,o),a(o,l),_&&_.m(l,null),a(l,s),a(l,x),a(o,d),h&&h.m(o,null),a(o,R),a(o,f),a(f,v),a(o,p),a(o,i),a(i,w),a(t,L),g&&g.m(t,null),a(t,z),a(t,H),a(H,V),J||(W=[B(l,"click",e[5]),B(f,"click",e[7]),B(i,"click",e[8])],J=!0)},p(m,[k]){m[1]?_||(_=ee(),_.c(),_.m(l,s)):_&&(_.d(1),_=null),k&2&&b!==(b=m[1]?"Running audit...":"Run Audit")&&G(x,b),k&2&&(l.disabled=m[1]),m[4]?h?h.p(m,k):(h=te(m),h.c(),h.m(o,R)):h&&(h.d(1),h=null),k&8&&c!==(c=!m[3])&&(f.disabled=c),k&8&&A!==(A=!m[3])&&(i.disabled=A),m[2]?g?g.p(m,k):(g=ne(m),g.c(),g.m(t,z)):g&&(g.d(1),g=null),k&1&&G(V,m[0])},i:M,o:M,d(m){m&&P(t),_&&_.d(),h&&h.d(),g&&g.d(),J=!1,C(W)}}}const Le=5e3;function re(e){return renderReport(e)}function $e(e,t,n){let r="Ready to audit",o=!1,l=null,s=null,b=!1;pe(()=>{$.ok("OnboardingAudit.ai popup initialized")});async function x(){n(2,l=null),n(1,o=!0),n(0,r="Running audit..."),$.start("Starting audit process");try{const c=new Promise((w,A)=>{setTimeout(()=>A(new Error("Audit timeout - please try refreshing the page and running again")),Le)}),p=chrome.runtime.sendMessage({type:"RUN_AUDIT"}),i=await Promise.race([p,c]);if(i!=null&&i.success&&(i!=null&&i.data))$.ok("Audit completed successfully"),d(i.data);else{const w=(i==null?void 0:i.error)||"Audit failed";throw $.error(`Audit failed: ${w}`),new Error(w)}}catch(c){const p=c.message||"Unknown error occurred";$.error(`Audit error: ${p}`),p.includes("timeout")?n(2,l="Audit timed out. Please refresh the page and try again."):p.includes("Extension context invalidated")?n(2,l="Extension needs to be reloaded. Please refresh the page and try again."):n(2,l=`Audit failed: ${p}. Please refresh the page and try again.`),n(0,r="Ready to audit"),n(1,o=!1)}}function d(c){$.ok(`Audit result received: ${JSON.stringify(c)}`),n(3,s=c),n(0,r=`Audit complete! Score: ${c.scores.overall}/100`),n(1,o=!1),n(4,b=!0)}function R(){if(!s)return;const c=re(s),p=new Blob([c],{type:"text/html"}),i=URL.createObjectURL(p);chrome.tabs.create({url:i})}function f(){if(!s){n(0,r="No audit data to export");return}const c=JSON.stringify(s,null,2),p=new Blob([c],{type:"application/json"}),i=URL.createObjectURL(p),w=document.createElement("a");w.href=i,w.download=`onboarding-audit-${s.id}.json`,w.click(),URL.revokeObjectURL(i),n(0,r="Audit exported successfully")}function v(){if(!s){n(0,r="No audit data to export");return}try{const c=re(s),p=new Blob([c],{type:"text/html"}),i=URL.createObjectURL(p),w=new URL(s.url).hostname.replace(/\./g,"-"),A=new Date(s.timestamp).toISOString().split("T")[0].replace(/-/g,""),L=document.createElement("a");L.href=i,L.download=`onboarding-audit-${w}-${A}.html`,L.click(),URL.revokeObjectURL(i),n(0,r="HTML report exported successfully")}catch(c){n(0,r=`Error exporting HTML: ${c.message}`)}}return[r,o,l,s,b,x,R,f,v]}class Oe extends Ae{constructor(t){super(),Re(this,t,$e,ve,ce,{})}}const je=new Oe({target:document.body});export{je as default};
