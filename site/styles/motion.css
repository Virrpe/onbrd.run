/* Motion: aurora drift + parallax layers
   Invariants:
   - Keep single hero gradient: do not set a new base background; rely on var(--hero-gradient) on the host.
   - No layout shifts: absolute layers only; transform/opacity animate; pointer-events: none.
   - Reduced motion: gated by prefers-reduced-motion AND html[data-motion].
*/

/* Gate: motion off unless html[data-motion="true"] */
html:not([data-motion="true"]) .parallax { display: none !important; }

/* Respect user preference */
@media (prefers-reduced-motion: reduce) {
  html[data-motion="true"] .parallax { display: none !important; }
}

/* Ensure hero clips overlays and establishes stacking context */
.hero { position: relative; z-index: 0; overflow: hidden; }

/* Host overlay (place inside hero container) */
.parallax {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 0;               /* Keep under content; content paints after this node */
  contain: paint;
}

.parallax__layer {
  position: absolute;
  inset: -10vmax;           /* Overscan to avoid edge cropping during transforms */
  background: transparent;  /* No base fill; overlays only */
  will-change: transform, opacity;
  filter: blur(40px);
  opacity: 0.55;
  transform: translate3d(0,0,0);
  mix-blend-mode: screen;   /* Gentle aurora over the existing hero gradient */
}

/* Aurora palette */
:root {
  --aurora-a: 202 100% 60%;  /* cyan */
  --aurora-b: 282 90% 64%;   /* violet */
  --aurora-c: 158 95% 55%;   /* teal */
  --aurora-alpha: 0.18;
}

.parallax__layer--back {
  background:
    radial-gradient(60vmax 60vmax at 15% 30%, hsl(var(--aurora-a) / var(--aurora-alpha)), transparent 60%),
    radial-gradient(70vmax 50vmax at 85% 20%, hsl(var(--aurora-b) / var(--aurora-alpha)), transparent 65%);
  animation: drift-back 36s ease-in-out infinite alternate;
}

.parallax__layer--mid {
  background:
    radial-gradient(50vmax 50vmax at 25% 80%, hsl(var(--aurora-c) / var(--aurora-alpha)), transparent 60%),
    radial-gradient(35vmax 35vmax at 70% 60%, hsl(var(--aurora-a) / calc(var(--aurora-alpha) * 0.9)), transparent 65%);
  animation: drift-mid 26s ease-in-out infinite alternate;
}

.parallax__layer--front {
  filter: blur(24px);
  opacity: 0.40;
  background:
    radial-gradient(30vmax 25vmax at 65% 35%, hsl(var(--aurora-b) / calc(var(--aurora-alpha) * 1.2)), transparent 60%),
    radial-gradient(25vmax 25vmax at 35% 55%, hsl(var(--aurora-c) / calc(var(--aurora-alpha) * 1.2)), transparent 65%);
  animation: drift-front 18s ease-in-out infinite alternate;
}

@keyframes drift-back {
  0%   { transform: translate3d(-2%, -1%, 0) scale(1.05) rotate(-0.5deg); }
  100% { transform: translate3d( 2%,  1%, 0) scale(1.08) rotate( 0.5deg); }
}
@keyframes drift-mid {
  0%   { transform: translate3d(-1%,  1%, 0) scale(1.03) rotate( 0.4deg); }
  100% { transform: translate3d( 1%, -1%, 0) scale(1.06) rotate(-0.4deg); }
}
@keyframes drift-front {
  0%   { transform: translate3d( 0.5%, -0.5%, 0) scale(1.02) rotate( 0.3deg); }
  100% { transform: translate3d(-0.5%,  0.5%, 0) scale(1.05) rotate(-0.3deg); }
}

/* Ensure overlays don’t introduce a second “base” gradient */
.parallax,
.parallax__layer {
  background-blend-mode: lighten;
}